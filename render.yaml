services:
  - type: web
    name: reservas-citas-api
    env: python
    plan: free
    pythonVersion: 3.12.0
    
    # Ejecutar build script antes de iniciar
    buildCommand: bash build.sh
    
    # Comando para iniciar la app
    startCommand: gunicorn config.wsgi:application --bind 0.0.0.0:$PORT --log-file -
    
    # Variables de entorno
    envVars:
      - key: DJANGO_SETTINGS_MODULE
        value: config.settings.prod
      - key: DEBUG
        value: "False"
      - key: ALLOWED_HOSTS
        value: "your-render-domain.onrender.com,localhost,127.0.0.1"
      - key: SECRET_KEY
        sync: false  # Debe ser set en Render dashboard
      - key: DATABASE_URL
        sync: false  # Debe ser set en Render dashboard
      - key: SECURE_SSL_REDIRECT
        value: "True"
      - key: SESSION_COOKIE_SECURE
        value: "True"
      - key: CSRF_COOKIE_SECURE
        value: "True"
    
    # Port
    port: 8000
    
    # Healthcheck
    healthCheckPath: /api/health/
